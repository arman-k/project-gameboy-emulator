# Project Gameboy Emulator

*Project Gameboy Emulator* is a personal endeavor in trying to create a Gameboy Emulator for Windows.

Except for the code generator, the whole project is intended to be done in FASM assembly. The purpose of the project and course of action might change over time, but it can be broadly summed up to:
   - Getting used to assembly and learning about optimization techniques (the current codebase doesn't exactly address optimization yet)
   - Learning the low-level Windows API - how things work under the hood in Windows operating system.
   - Learning how a microprocessor actually works. Learning how it interfaces and interacts with various hardware and being able to emulate that behavior.
   - Learning how game programming used to be done in the old console days. Learn how to reverse engineer their ROM images and modify their memory to change game properties, etc.

For now, I only have a crude disassembler prepared.

Anyways, the codebase is organized as follows:

**codegen**:
  - codegen.c 
  - opdb.txt
  - opcbdb.txt

*Codegen* is a code generator written in C that generates instructions and strings required by the disassembler. opdb.txt and opcbdb.txt are files that contain various properties of the opcodes of the Gameboy CPU in a usable format. codegen.c uses these text files to load the properties into memory. Based upon these properties, codegen can then be programmed and delegated to generate repetitive code for various purposes.

**disassembler**:
  - decode.asm
  - decode_op.asm
  - decode_str.asm
  - disasm.asm
  - disasm_h.inc
  - rom_info.asm
  - sample_rom.gb

*Disassembler* is a crude attempt in trying to disassemble a Gameboy ROM. It sequentially interprets all the bytes in the rom as instructions. This is of course wrong but can still be made useful with manual inspection. Creating a more complex disassembler would be an overkill and a distraction from the main project (it is not actually necessary) - the Gameboy Emulator itself. I still felt like it would be a nice thing to have and it helps verify that the ROM indeed is made for the Gameboy.

disasm.asm is the main source file and all the other files are imported within it. It reads the ROM into memory and then runs dissassembly on it. disasm_h.inc is a header file containing some WINAPI constants. decode.asm contains the decoding logic for opcodes. decode_op.asm is generated by codegen and contains instructions required for decoding. decode_str.asm is also generated by codegen and contains string required while printing the decoded assembly instructions. Both the files are embedded in decode.asm. rom_info.asm extracts various information embedded in the ROM and also verifies the checksum of the file. sample_rom.gb is a sample Pokemon Blue Gameboy ROM which you can use to test the disassembler.

Please read the corresponding source files to know how they work and how they are structured. 

To compile the disassembler you will need FASM for Windows. Open your terminal and simply run this command.

```
$ fasm disasm.asm
```

Once the assembly is done, run this command to generate the disassembled file.

```
$ disasm sample_rom.gb > dump.txt
```

You should pipe the output to some dumpfile because it consists of over a million lines of Gameboy assembly code and the disassembler does not implicitly write the contents to a file. If the extra newlines bother you, check the header note in disasm.asm to fix that.

**Have fun playing with various ROMs!**

***To be continued...***